{% extends 'admin/Inicio/index.html' %}
{% block conteudo %}
{% load static %}

<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>{%block title%}Cadastro de Cliente{% endblock title %}</title>
    <link rel="stylesheet" href="{% static 'Css/cadastro/cadastroCliente.css' %}">
</head>
<body>

    <h2 style="text-align:center;">Cadastro de Cliente</h2>

    <form method="POST" action="{% url 'cadastro_cliente' %}">
        {% csrf_token %}
        <label for="{{ form.nome.id_for_label }}">Nome:</label>
        {{ form.nome }}

        <label for="{{ form.cpf.id_for_label }}">CPF:</label>
        {{ form.cpf }}
        {{ form.cpf.errors }}

        <label for="{{ form.cnpj.id_for_label }}">CNPJ:</label>
        {{ form.cnpj }}
        {{ form.cnpj.errors }}

        <label for="{{ form.telefone.id_for_label }}">Telefone:</label>
        {{ form.telefone }}
        {{ form.telefone.errors }}

        <label for="{{ form.email.id_for_label }}">Email:</label>
        {{ form.email }}
        {{ form.email.errors }}

        <button type="submit">Salvar Cliente</button>

        {% if messages %}
            {% for message in messages %}
            <div class="message {{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}
    </form>
    
    <script>
        function formatarCPF(cpf) {
            cpf = cpf.replace(/\D/g, "");
            cpf = cpf.replace(/(\d{3})(\d)/, "$1.$2");
            cpf = cpf.replace(/(\d{3})(\d)/, "$1.$2");
            cpf = cpf.replace(/(\d{3})(\d{1,2})$/, "$1-$2");
            return cpf;
        }

        function formatarCNPJ(cnpj) {
            cnpj = cnpj.replace(/\D/g, "");
            cnpj = cnpj.replace(/^(\d{2})(\d)/, "$1.$2");
            cnpj = cnpj.replace(/^(\d{2})\.(\d{3})(\d)/, "$1.$2.$3");
            cnpj = cnpj.replace(/\.(\d{3})(\d)/, ".$1/$2");
            cnpj = cnpj.replace(/(\d{4})(\d)/, "$1-$2");
            return cnpj;
        }

        function formatarTelefone(telefone) {
            telefone = telefone.replace(/\D/g, "");
            if (telefone.length <= 10) {
                telefone = telefone.replace(/(\d{2})(\d{4})(\d{0,4})/, "($1) $2-$3");
            } else {
                telefone = telefone.replace(/(\d{2})(\d{5})(\d{0,4})/, "($1) $2-$3");
            }
            return telefone.trim().slice(0, 15);
        }

        document.addEventListener("DOMContentLoaded", function () {
            const cpfInput = document.getElementById("id_cpf");
            const cnpjInput = document.getElementById("id_cnpj");
            const telefoneInput = document.getElementById("id_telefone");

            if (cpfInput) {
                cpfInput.addEventListener("input", function () {
                    this.value = formatarCPF(this.value);
                });
            }

            if (cnpjInput) {
                cnpjInput.addEventListener("input", function () {
                    this.value = formatarCNPJ(this.value);
                });
            }
            if (telefoneInput) {
                telefoneInput.addEventListener("input", function () {
                    this.value = formatarTelefone(this.value);
                });
            }
        });
</script>

{% endblock conteudo %}

</body>
</html>
